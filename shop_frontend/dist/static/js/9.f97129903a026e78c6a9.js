webpackJsonp([9],{"a/eu":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("3SZ7"),r=a.n(s),o=a("m4jk"),l={data:function(){var e=this;return{uploadedFile:null,loadingStatus:!1,dateRange:[new Date((new Date).getTime()-2592e5),new Date((new Date).getTime()+1728e5)],dateOptions:{shortcuts:[{text:"最近一周",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:"最近一个月",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}},{text:"最近三个月",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]}}]},keyword:"",showAddModal:!1,showEditModal:!1,showDeleteModal:!1,addModel:{username:"",first_name:"",last_name:"",cell_phone:"",email:""},addModelErrors:{},editModel:{username:"",first_name:"",last_name:"",cell_phone:"",email:""},editModelErrors:{},ruleValidate:{username:[{required:!0,message:"名字必须的哦",trigger:"blur"}],first_name:[{min:1,message:"至少一个字吧",trigger:"blur"}],last_name:[{min:1,message:"至少一个字吧",trigger:"blur"}],cell_phone:[{required:!0,message:"留个电话吧",trigger:"blur"}]},self:this,tableData:[],total:0,pageNumber:1,pageSize:10,tableColumns:[{title:"用户名",key:"username",align:"center",sortable:!0},{title:this.$t("last_name"),key:"last_name",align:"left"},{title:this.$t("first_name"),key:"first_name",align:"left"},{title:this.$t("action"),key:"action",width:150,align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showEdit(a.index)}}},e.$t("edit"))])}}]}},computed:{aList:function(){var e=this;return Array.isArray(this.tableData)?this.tableData.filter(function(t,a,s){return!e.keyword||(-1!==t.username.toUpperCase().indexOf(e.keyword.toUpperCase())?s.indexOf(t)===a:-1!==t.last_name.toString().indexOf(e.keyword.toUpperCase())||(-1!==t.first_name.toUpperCase().indexOf(e.keyword.toUpperCase())||-1!==t.cell_phone.toUpperCase().indexOf(e.keyword.toUpperCase())))}):[]}},methods:{showEdit:function(e){this.showEditModal=!0,this.editModel=this.aList[e]},getCustomerData:function(e,t){var a=this;this.loadingStatus=!0;var s={start:this.dateRange[0].getFullYear()+"-"+(this.dateRange[0].getMonth()+1)+"-"+this.dateRange[0].getDate(),end:this.dateRange[1].getFullYear()+"-"+(this.dateRange[1].getMonth()+1)+"-"+this.dateRange[1].getDate(),keyword:this.keyword,limit:e,offset:(t-1)*e};Object(o.u)(s).then(function(e){var t=e.data,s=e.status,r=e.statusText;200!==s?a.loginMessage=r:(console.log(t),a.$Loading.finish(),a.total=e.data.count,a.tableData=t.results)},function(e){console.log("Error in searchCustomers: "+e),a.$Message.error("获取客户列表失败!")}).catch(function(e){console.log("catched in searchCustomers:"+e),a.$Message.error("获取客户列表失败!")}),this.loadingStatus=!1},changePage:function(e){console.log(e),this.pageNumber=e,this.getCustomerData(this.pageSize,this.pageNumber)},changePageSize:function(e){console.log(e),this.pageSize=e,this.getCustomerData(this.pageSize,this.pageNumber)},exportData:function(e){1===e?this.$refs.table.exportCsv({filename:"CustomerList"+new Date}):2===e?this.$refs.table.exportCsv({filename:"CustomerList_sorted_filtered"+new Date,original:!1}):3===e&&this.$refs.table.exportCsv({filename:"CustomerList_customed"+new Date,columns:this.tableColumns.filter(function(e,t){return t<4}),data:this.aList.filter(function(e,t){return t<10})})},cancelAdd:function(){this.showAddModel=!1,this.$Message.info("点击了取消")},confirmAdd:function(e){var t=this;this.$refs[e].validate(function(a){if(a){t.addModelErrors={};var s=r()(t.addModel);s=JSON.parse(s),Object(o.e)(s).then(function(e){var a=e.data,s=e.status,r=e.statusText;201!==s?(t.loginMessage=r,t.addModelErrors=a,t.$Message.error("添加客户失败!"),t.showAddModel=!0):(console.log(a),t.$Message.success("添加客户成功!"),t.getCustomerData(t.pageSize,t.pageNumber))},function(e){console.log("Error in addCustomer: "+e),t.$Message.error("添加客户失败!")}).catch(function(e){console.log("Exception in addCustomer: "+e),t.$Message.error("添加客户失败!")})}else console.log(t.$refs[e].errors),console.log(t.addModel),t.$Message.error("表单验证失败!")})},cancelEdit:function(){this.showEditModel=!1,this.$Message.info("点击了取消")},confirmEdit:function(e){var t=this;this.$refs[e].validate(function(e){if(e){t.editModelErrors={};var a=JSON.parse(r()(t.editModel));Object(o.y)(a).then(function(e){var a=e.data,s=e.status,r=e.statusText;201!==s?(console.log(r),t.editModelErrors=a,t.$Message.error(s),t.showEditModel=!0):(a.sale_price=Number(a.sale_price),a.price=Number(a.price),console.log(a),t.$Message.success("修改客户成功!"),t.getCustomerData(t.pageSize,t.pageNumber))},function(e){console.log("Error in editCustomer: "+e),t.$Message.error("修改客户失败!")}).catch(function(e){console.log("catched in editCustomer:"+e),t.$Message.error("修改客户失败!")})}else t.$Message.error("客户信息校验失败!")})},handleReset:function(e){this.$refs[e].resetFields()},handleFormatError:function(){this.$Message.error(this.$t("format_error"))}},mounted:function(){this.getCustomerData(this.pageSize,this.pageNumber)}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"customer-manage"},[a("Row",{staticClass:"search-box"},[a("Col",{attrs:{span:"8"}},[a("AutoComplete",{attrs:{placeholder:e.$t("localSearch"),icon:"ios-Textsearch",clearable:!0},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},e._l(e.aList,function(t){return a("Option",{key:t.id,attrs:{value:t.username}},[a("span",{staticClass:"customer-name"},[e._v(e._s(t.username))]),e._v(" "),a("span",{staticClass:"customer-price"},[e._v(e._s(t.cell_phone))]),e._v(" "),a("span",{staticClass:"customer-price"},[e._v(e._s(t.last_name))]),e._v(" "),a("span",{staticClass:"customer-price"},[e._v(e._s(t.first_name))])])}))],1),e._v(" "),a("Col",{attrs:{span:"3"}},[a("i-button",{attrs:{type:"primary"},on:{click:function(t){e.getCustomerData(e.pageSize,e.pageNumber)}}},[e._v(e._s(e.$t("remoteSearch")))])],1),e._v(" "),a("Col",{attrs:{span:"4",push:"9"}},[a("i-button",{attrs:{type:"primary"},on:{click:function(t){e.showAddModal=!0}}},[e._v(e._s(e.$t("addCustomer")))])],1)],1),e._v(" "),a("Table",{ref:"table",staticClass:"data-table",attrs:{loading:e.loadingStatus,context:e.self,data:e.aList,columns:e.tableColumns,stripe:""}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.total,current:e.pageNumber,"show-sizer":"","show-elevator":"","show-total":"","page-size":e.pageSize,"page-size-opts":[10,20,40,1e4]},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)]),e._v(" "),a("Modal",{attrs:{title:"添加客户"},on:{"on-ok":function(t){e.confirmAdd("addModelForm")},"on-cancel":function(t){e.cancelAdd("addModelForm")}},model:{value:e.showAddModal,callback:function(t){e.showAddModal=t},expression:"showAddModal"}},[a("Form",{ref:"addModelForm",attrs:{model:e.addModel,rules:e.ruleValidate,"label-width":100,enctype:"multipart/form-data","accept-charset":"utf-8"}},[a("Form-item",{attrs:{label:e.$t("username"),prop:"username"}},[a("Input",{attrs:{placeholder:e.$t("username")},model:{value:e.addModel.username,callback:function(t){e.$set(e.addModel,"username",t)},expression:"addModel.username"}}),e._v(" "),e._l(e.addModelErrors.username,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2),e._v(" "),a("Form-item",{attrs:{label:e.$t("cell_phone"),prop:"cell_phone"}},[a("Input",{attrs:{placeholder:e.$t("cell_phone")},model:{value:e.addModel.cell_phone,callback:function(t){e.$set(e.addModel,"cell_phone",t)},expression:"addModel.cell_phone"}}),e._v(" "),e._l(e.addModelErrors.cell_phone,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2),e._v(" "),a("Form-item",{attrs:{label:e.$t("last_name"),prop:"last_name"}},[a("Input",{attrs:{placeholder:e.$t("last_name")},model:{value:e.addModel.last_name,callback:function(t){e.$set(e.addModel,"last_name",t)},expression:"addModel.last_name"}}),e._v(" "),e._l(e.addModelErrors.last_name,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2),e._v(" "),a("Form-item",{attrs:{label:e.$t("first_name"),prop:"first_name"}},[a("Input",{attrs:{placeholder:e.$t("first_name")},model:{value:e.addModel.first_name,callback:function(t){e.$set(e.addModel,"first_name",t)},expression:"addModel.first_name"}}),e._v(" "),e._l(e.addModelErrors.first_name,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2),e._v(" "),a("Form-item",{attrs:{label:e.$t("email"),prop:"email"}},[a("Input",{attrs:{placeholder:e.$t("email")},model:{value:e.addModel.email,callback:function(t){e.$set(e.addModel,"email",t)},expression:"addModel.email"}}),e._v(" "),e._l(e.addModelErrors.email,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2)],1)],1),e._v(" "),a("Modal",{attrs:{title:e.$t("customerManage")},on:{"on-ok":function(t){e.confirmEdit("editModelForm")},"on-cancel":function(t){e.cancelEdit("editModelForm")}},model:{value:e.showEditModal,callback:function(t){e.showEditModal=t},expression:"showEditModal"}},[a("Form",{ref:"editModelForm",attrs:{model:e.editModel,rules:e.ruleValidate,"label-width":100,enctype:"multipart/form-data","accept-charset":"utf-8"}},[a("Form-item",{attrs:{label:e.$t("username"),prop:"username"}},[a("Input",{attrs:{placeholder:e.$t("username")},model:{value:e.editModel.username,callback:function(t){e.$set(e.editModel,"username",t)},expression:"editModel.username"}}),e._v(" "),e._l(e.editModelErrors.username,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2),e._v(" "),a("Form-item",{attrs:{label:e.$t("cell_phone"),prop:"cell_phone"}},[a("Input",{attrs:{placeholder:e.$t("cell_phone")},model:{value:e.editModel.cell_phone,callback:function(t){e.$set(e.editModel,"cell_phone",t)},expression:"editModel.cell_phone"}}),e._v(" "),e._l(e.editModelErrors.cell_phone,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2),e._v(" "),a("Form-item",{attrs:{label:e.$t("last_name"),prop:"last_name"}},[a("Input",{attrs:{placeholder:e.$t("last_name")},model:{value:e.editModel.last_name,callback:function(t){e.$set(e.editModel,"last_name",t)},expression:"editModel.last_name"}}),e._v(" "),e._l(e.editModelErrors.last_name,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2),e._v(" "),a("Form-item",{attrs:{label:e.$t("first_name"),prop:"first_name"}},[a("Input",{attrs:{placeholder:e.$t("first_name")},model:{value:e.editModel.first_name,callback:function(t){e.$set(e.editModel,"first_name",t)},expression:"editModel.first_name"}}),e._v(" "),e._l(e.editModelErrors.first_name,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2),e._v(" "),a("Form-item",{attrs:{label:e.$t("email"),prop:"email"}},[a("Input",{attrs:{placeholder:e.$t("email")},model:{value:e.editModel.email,callback:function(t){e.$set(e.editModel,"email",t)},expression:"editModel.email"}}),e._v(" "),e._l(e.editModelErrors.email,function(t){return a("ul",[a("li",{staticClass:"error"},[e._v(e._s(t))])])})],2)],1)],1)],1)},staticRenderFns:[]};var i=a("ngHh")(l,n,!1,function(e){a("b7SE")},"data-v-8f22b658",null);t.default=i.exports},b7SE:function(e,t){}});
//# sourceMappingURL=9.f97129903a026e78c6a9.js.map