{"version":3,"sources":["webpack:///src/views/OrderAdd.vue","webpack:///./src/views/OrderAdd.vue?9179","webpack:///./src/views/OrderAdd.vue","webpack:///src/views/components/cart/CartItems.vue","webpack:///./src/views/components/cart/CartItems.vue?2833","webpack:///./src/views/components/cart/CartItems.vue"],"names":["OrderAdd","_this","this","validator","callback","trigger","value","h","params","row","sale_price","Number","amount","toFixed","decimals","product_sale_price","foFixed","index","computed","extends_default","Object","vuex_esm","maxSize","currentDepartment","availableProducts","availableExpresses","availablePayments","cartList","_this2","name","availableStocks","_this3","availableCustomers","_this4","_this5","pageNumber","_this6","code","pageSize","data","res","statusText","count","results","error","_this7","_this8","_this9","customer","_this10","express","_this11","payment","_this12","comment","_this13","valid","selectedCustomer","selectedPayment","cartListCount","selectedExpress","express_no","message","views_OrderAdd","render","_vm","_h","$createElement","_c","_self","staticClass","_v","ref","attrs","model","addModel","rules","ruleAddValidate","label-position","inline","label","$t","prop","placeholder","icon","clearable","on","on-select","handleProductSelected","$$v","$set","expression","_l","option","key","id","product_name","_s","_f","batch_no","addModelErrors","max","min","step","type","click","$event","addToCart","orderModel","ruleOrderValidate","handleCustomerSelected","username","last_name","first_name","cell_phone","orderErrors","handlePaymentSelected","handleExpressSelected","staticStyle","display","size","submitOrder","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","CartItems","props","param","department","currentUser","tmpArray","methods","cart_CartItems","stripe","columns","cartListColumns","slot","cartListSum"],"mappings":"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","file":"static/js/6.6fbf6d98c266eaaa08bc.js","sourcesContent":["<template>\n  <div class=\"order-manage\">\n    <!-- 已添加列表 -->\n    <div class=\"cart-items\">\n      <cart-items>\n      </cart-items>\n    </div>\n\n    <!-- 录入框 -->\n    <div class=\"cart-enter\">\n      <Form ref=\"addModelForm\" :model=\"addModel\" :rules=\"ruleAddValidate\"  label-position=\"left\" inline>\n        <Form-item :label=\"$t('product')\" prop=\"name\">\n          <AutoComplete v-model=\"addModel.name\" :placeholder=\"$t('selectProduct')\" icon=\"ios-search\" \n            :clearable=\"true\"\n            @on-select=\"handleProductSelected\">\n            <Option v-for=\"option in aStockProduct\" :value=\"option.product_name\" :key=\"option.id\">\n              <span class=\"product-name\">{{ option.product_name }}</span>\n              <span class=\"product-sale-price\">{{ option.product_sale_price | currency }}</span>\n              <span class=\"product-amount\">{{ option.amount }}</span>\n              <span class=\"product-batch-no\">{{ option.batch_no }}</span>\n            </Option>\n          </AutoComplete>\n          <ul v-for=\"error in addModelErrors.name\">\n            <li class=\"error\">{{ error }}</li>\n          </ul>\n        </Form-item>\n        <Form-item :label=\"$t('amount')\" prop=\"amount\">\n          <InputNumber :max=\"10000\" :min=\"0.1\" :step=\"0.1\" v-model=\"addModel.amount\"></InputNumber>\n          <ul v-for=\"error in addModelErrors.amount\">\n            <li class=\"error\">{{ error }}</li>\n          </ul>\n        </Form-item>\n        <Form-item :label=\"$t('comment')\" prop=\"comment\">\n          <Input v-model=\"addModel.comment\" type=\"text\"></Input>\n          <ul v-for=\"error in addModelErrors.comment\">\n            <li class=\"error\">{{ error }}</li>\n          </ul>\n        </Form-item>\n        <Form-item>\n          <br/>\n          <Button type=\"primary\" @click=\"addToCart()\">{{ $t('addToCart') }}</Button>\n        </Form-item>\n      </Form>\n      <br/>\n    </div>\n\n    <div class=\"order-info\">\n      <Form ref=\"submitOrderForm\" :model=\"orderModel\" :rules=\"ruleOrderValidate\"  label-position=\"left\" inline>\n        <Form-item :label=\"$t('customer')\" prop=\"customer\">\n          <AutoComplete v-model=\"orderModel.customer\" :placeholder=\"$t('selectCustomer')\" icon=\"ios-search\" \n            :clearable=\"true\"\n            @on-select=\"handleCustomerSelected\"\n          >\n            <Option v-for=\"option in aCustomer\" :value=\"option.username\" :key=\"option.id\">\n              <span class=\"product-name\">{{ option.username }}</span>\n              <span class=\"product-price\">{{ option.last_name }}</span>\n              <span class=\"product-price\">{{ option.first_name }}</span>\n              <span class=\"product-price\">{{ option.cell_phone }}</span>\n            </Option>\n          </AutoComplete>\n          <ul v-for=\"error in orderErrors.customer\">\n            <li class=\"error\">{{ error }}</li>\n          </ul>\n        </Form-item>\n        <Form-item :label=\"$t('payment')\" prop=\"payment\">\n          <AutoComplete v-model=\"orderModel.payment\" :placeholder=\"$t('selectPayment')\" icon=\"ios-search\" \n            :clearable=\"true\"\n            @on-select=\"handlePaymentSelected\"\n          >\n            <Option v-for=\"option in aPayment\" :value=\"option.name\" :key=\"option.id\">\n              <span class=\"product-name\">{{ option.name }}</span>\n            </Option>\n          </AutoComplete>\n          <ul v-for=\"error in orderErrors.payment\">\n            <li class=\"error\">{{ error }}</li>\n          </ul>\n        </Form-item>\n        <Form-item :label=\"$t('express')\" prop=\"express\">\n          <AutoComplete v-model=\"orderModel.express\" :placeholder=\"$t('selectExpress')\" icon=\"ios-search\" \n            :clearable=\"true\"\n            @on-select=\"handleExpressSelected\"\n          >\n            <Option v-for=\"option in aExpress\" :value=\"option.name\" :key=\"option.id\">\n              <span class=\"product-name\">{{ option.name }}</span>\n            </Option>\n          </AutoComplete>\n          <ul v-for=\"error in orderErrors.express\">\n            <li class=\"error\">{{ error }}</li>\n          </ul>\n        </Form-item>\n        <Form-item :label=\"$t('expressNo')\" prop=\"express_no\">\n          <Input v-model=\"orderModel.express_no\" type=\"text\"></Input>\n          <ul v-for=\"error in orderErrors.express_no\">\n            <li class=\"error\">{{ error }}</li>\n          </ul>\n        </Form-item>\n        <Form-item :label=\"$t('comment')\" prop=\"comment\">\n          <Input v-model=\"orderModel.comment\" type=\"text\"></Input>\n          <ul v-for=\"error in orderErrors.comment\">\n            <li class=\"error\">{{ error }}</li>\n          </ul>\n        </Form-item>\n        <Form-item style=\"display: none\" prop=\"cartListLength\">\n          <InputNumber v-model=\"orderModel.cartListLength\" type=\"text\"></InputNumber>\n        </Form-item>\n        <Form-item>\n          <br/>\n          <Button type=\"primary\" size=\"large\" @click=\"submitOrder\"><Icon type=\"ios-download-outline\"></Icon>{{ $t('submitOrder') }}</Button>\n        </Form-item>\n      </Form>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { mapState, mapGetters } from 'vuex'\n  import { searchStocks, getCustomers, addOrder } from '@/http/api'\n  import CartItems from '@/views/components/cart/CartItems.vue'\n\n  export default {\n    components: {\n      'cart-items': CartItems\n    },\n    data: function () {\n      const validateProductName = (rule, value, callback) => {\n        if (!value) {\n          callback(new Error(this.$t('noProductError')))\n        } else {\n          if (this.availableProducts.filter((val, index, array) => val.name === value).length > 0) {\n            callback()\n          } else {\n            callback(new Error(this.$t('invalidProductError')))\n          }\n        }\n      }\n      const validateAmount = (rule, value, callback) => {\n        // console.log(value)\n        if (!value) {\n          callback(new Error(this.$t('noAmountError')))\n        } else {\n          if (value === 0) {\n            callback(new Error(this.$t('invalidAmountError')))\n          } else {\n            callback()\n          }\n        }\n      }\n      const validateCustomer = (rule, value, callback) => {\n        console.log(value)\n        if (!value) {\n          callback(new Error(this.$t('noCustomerError')))\n        } else {\n          if (this.availableCustomers.some((val, index, array) => val.username === value)) {\n            console.log('name valide')\n            callback()\n          } else {\n            console.log('name invalide')\n            callback(new Error(this.$t('invalidCustomerError')))\n          }\n        }\n      }\n      const validatePayment = (rule, value, callback) => {\n        if (!value) {\n          callback()\n        } else {\n          if (this.availablePayments.some((val, index, array) => val.name === value)) {\n            console.log('name valide')\n            callback()\n          } else {\n            console.log('name invalide')\n            callback(new Error(this.$t('invalidPaymentError')))\n          }\n        }\n      }\n      const validateCartListLength = (rule, value, callback) => {\n        if (this.cartList.length === 0) {\n          callback(new Error(this.$t('invalidCartListLengthError')))\n        } else {\n          callback()\n        }\n      }\n      return {\n        availableStocks: [],\n        selectedProduct: null,\n        availableCustomers: [],\n        selectedCustomer: null,\n        addModel: {\n          name: '', // 绑定以后没有选项时会被赋值成undefined\n          amount: 0.0,\n          comment: ''\n        },\n        ruleAddValidate: {\n          name: [\n            { validator: validateProductName, trigger: 'blur' }\n          ],\n          amount: [\n            { validator: validateAmount, trigger: 'blur' }\n          ]\n        },\n        addModelErrors: {},\n        orderModel: {\n          customer: '',\n          payment: '',\n          express: '',\n          express_no: '',\n          cartListLength: 0\n        },\n        ruleOrderValidate: {\n          customer: [\n            { validator: validateCustomer, trigger: 'blur' }\n          ],\n          payment: [\n            { validator: validatePayment, trigger: 'blur' }\n          ],\n          cartListLength: [\n            { validator: validateCartListLength, trigger: 'blur' }\n          ]\n        },\n        orderErrors: {},\n        addedProducts: [],\n        total: 0,\n        pageNumber: 1,\n        pageSize: 100000,\n        tableColumns: [\n          {\n            title: '名称',\n            key: 'product_name',\n            align: 'center',\n            sortable: true\n          },\n          {\n            title: '价格',\n            key: 'product_sale_price',\n            align: 'left',\n            sortable: true,\n            render: (h, params) => {\n              return h(\n                'span',\n                params.row.sale_price\n              )\n            }\n          },\n          {\n            title: '数量',\n            key: 'amount',\n            align: 'center',\n            sortable: true,\n            render: (h, params) => {\n              return h('span', {\n              }, Number(params.row.amount).toFixed(this.decimals))\n            }\n          },\n          {\n            title: '小计',\n            key: 'itemSum',\n            align: 'left',\n            sortable: true,\n            render: (h, params) => {\n              return h('span', {\n                props: {\n                  color: 'red'\n                }\n              }, (Number(params.row.product_sale_price) * Number(params.row.amount)).foFixed(this.decimals))\n            }\n          },\n          {\n            title: '备注',\n            key: 'comment',\n            align: 'left',\n            sortable: true\n          },\n          {\n            title: '操作',\n            key: 'action',\n            width: 150,\n            align: 'center',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'primary',\n                    size: 'small'\n                  },\n                  style: {\n                    marginRight: '5px'\n                  },\n                  on: {\n                    click: () => {\n                      this.showEdit(params.index)\n                    }\n                  }\n                }, '编辑'),\n                h('Button', {\n                  props: {\n                    type: 'primary',\n                    size: 'small'\n                  },\n                  style: {\n                    marginRight: '5px'\n                  },\n                  on: {\n                    click: () => {\n                      this.showDelete(params.index)\n                    }\n                  }\n                }, '开/关')\n              ])\n            }\n          }\n        ]\n      }\n    },\n    computed: {\n      ...mapState('app', {\n        'maxSize': state => state.maxSize,\n        'currentDepartment': state => state.currentDepartment,\n        'availableProducts': state => state.availableProducts,\n        'availableExpresses': state => state.availableExpresses,\n        'availablePayments': state => state.availablePayments\n      }),\n      ...mapState('login', {\n        'currentDepartment': state => state.currentDepartment\n      }),\n      ...mapState('cart', {\n        'cartList': state => state.cartList,\n        'decimals': state => state.decimals\n      }),\n      ...mapGetters('cart', [\n        'cartListCount',\n        'cartListSum'\n      ]),\n      aStockProduct: function () {\n        // filter, concat, slice方法会生成亲的数组\n        // 手工敲入的字母会被赋值给addModel.name\n        // 使用删除修改选择的内容时会触发两次aProduc计算，\n        // 一次addModel.name值为undefined，一次为空字符串\n        console.log(this.addModel.name)\n        console.log(this.availableStocks)\n        return this.availableStocks.filter((item, index, array) => {\n          if (this.addModel.name) {\n            if (item.product_name.toUpperCase().indexOf(this.addModel.name.toUpperCase()) !== -1) {\n              return true\n            } else if (item.product_sale_price.toString().indexOf(this.addModel.name.toUpperCase()) !== -1) {\n              return true\n            } else if (item.product_pinyin.toUpperCase().indexOf(this.addModel.name.toUpperCase()) !== -1) {\n              return true\n            } else if (item.product_py.toUpperCase().indexOf(this.addModel.name.toUpperCase()) !== -1) {\n              return true\n            } else {\n              return false\n            }\n          } else {\n            return true\n          }\n        })\n      },\n      aCustomer: function () {\n        // 用于autocomplete\n        // console.log(this.orderModel.customer)\n        // console.log(Array.isArray(this.availableCustomers))\n        if (Array.isArray(this.availableCustomers)) {\n          return this.availableCustomers.filter((item, index, array) => {\n            // 删除选择项内容时，对应的值会被赋值成undefined\n            // console.log(item)\n            if (this.orderModel.customer) {\n              if (item.username.toUpperCase().indexOf(this.orderModel.customer.toUpperCase()) !== -1) {\n                return true\n              } else if (item.cell_phone.toUpperCase().indexOf(this.orderModel.customer.toUpperCase()) !== -1) {\n                return true\n              } else {\n                return false\n              }\n            } else {\n              return true\n            }\n          })\n        } else {\n          return this.availableCustomers\n        }\n      },\n      aExpress: function () {\n        // 用于autocomplete\n        if (Array.isArray(this.availableExpresses)) {\n          // filter不修改原array\n          return this.availableExpresses.filter((item, index, array) => {\n            if (this.orderModel.express) {\n              if (item.name.toUpperCase().indexOf(this.orderModel.express.toUpperCase()) !== -1) {\n                return true\n              } else if (item.pinyin.toUpperCase().indexOf(this.orderModel.express.toUpperCase()) !== -1) {\n                return true\n              } else if (item.py.toUpperCase().indexOf(this.orderModel.express.toUpperCase()) !== -1) {\n                return true\n              } else {\n                return false\n              }\n            } else {\n              return true\n            }\n          })\n        } else {\n          return this.availableExpresses\n        }\n      },\n      aPayment: function () {\n        // 用于autocomplete\n        // console.log(this.orderModel.payment)\n        // console.log(this.availablePayments)\n        if (Array.isArray(this.availablePayments)) {\n          // 深度拷贝方法\n          return this.availablePayments.filter((item, index, array) => {\n            if (this.orderModel.payment) {\n              if (item.name.toUpperCase().indexOf(this.orderModel.payment.toUpperCase()) !== -1) {\n                return true\n              } else if (item.pinyin.toUpperCase().indexOf(this.orderModel.payment.toUpperCase()) !== -1) {\n                return true\n              } else if (item.py.toUpperCase().indexOf(this.orderModel.payment.toUpperCase()) !== -1) {\n                return true\n              } else {\n                return false\n              }\n            } else {\n              return true\n            }\n          })\n        } else {\n          return this.availablePayments\n        }\n      }\n    },\n    watch: {\n      currentDepartment () {\n        this.getStockData(this.pageSize, this.pageNumber)\n      }\n    },\n    methods: {\n      // 获取商品列表\n      getStockData: function (pageSize, pageNumber) {\n        let paras = {\n          department: this.currentDepartment.code,\n          limit: pageSize,\n          offset: (pageNumber - 1) * pageSize\n        }\n        searchStocks(paras).then((res) => {\n          let { data, status, statusText } = res\n          if (status !== 200) {\n            this.loginMessage = statusText\n          } else {\n            // console.log(data)\n            this.total = res.data.count\n            this.availableStocks = data.results\n          }\n        }, (error) => {\n          console.log('Error in getStockDatas: ' + error)\n          this.$Message.error('获取商品列表失败!')\n        }).catch((error) => {\n          console.log('catched in getStockDatas:' + error)\n          this.$Message.error('获取商品列表失败!')\n        })\n        this.loadingStatus = false\n      },\n      // 获取顾客列表\n      getCustomerData: function (pageSize, pageNumber) {\n        let paras = {\n          limit: pageSize,\n          offset: (pageNumber - 1) * pageSize\n        }\n        getCustomers(paras).then((res) => {\n          let { data, status, statusText } = res\n          if (status !== 200) {\n            this.loginMessage = statusText\n          } else {\n            this.total = res.data.count\n            this.availableCustomers = data.results\n          }\n        }, (error) => {\n          this.$Message.error(error)\n        }).catch((error) => {\n          this.$Message.error(error)\n        })\n        this.loadingStatus = false\n      },\n      handleProductSelected: function (value) {\n        // console.log('handleProductSelected')\n        this.addModel.name = value\n        if (value) {\n          if (this.addModel.name.length > 0 && this.availableProducts.length > 0) {\n            let tmpProduct = this.availableProducts.filter((val, index, array) => val.name === this.addModel.name)\n            this.selectedProduct = tmpProduct[0]\n          } else {\n            console.error('invalideProduct')\n            this.$Message.error('invalideProduct')\n          }\n        }\n      },\n      handleCustomerSelected: function (value) {\n        this.orderModel.customer = value\n        if (value) {\n          if (this.orderModel.customer.length > 0 && this.availableCustomers.length > 0) {\n            let tmpCustomer = this.availableCustomers.filter((val, index, array) => val.username === this.orderModel.customer)\n            this.selectedCustomer = tmpCustomer[0]\n          } else {\n            this.$Message.error('invalideCustomer')\n          }\n        }\n      },\n      handleExpressSelected: function (value) {\n        this.orderModel.express = value\n        if (value) {\n          if (this.orderModel.express.length > 0 && this.availableExpresses.length > 0) {\n            let tmpExpress = this.availableExpresses.filter((val, index, array) => val.name === this.orderModel.express)\n            this.selectedExpress = tmpExpress[0]\n          } else {\n            this.$Message.error('invalideExpresses')\n          }\n        }\n      },\n      handlePaymentSelected: function (value) {\n        this.orderModel.payment = value\n        if (value) {\n          if (this.orderModel.payment.length > 0 && this.availablePayments.length > 0) {\n            let tmpPayment = this.availablePayments.filter((val, index, array) => val.name === this.orderModel.payment)\n            this.selectedPayment = tmpPayment[0]\n          } else {\n            this.$Message.error('invalidePayment')\n          }\n        }\n      },\n      addToCart: function () {\n        console.log('addToCart')\n        this.$refs['addModelForm'].validate((valid) => {\n          console.log('addToCart validating')\n          if (valid) {\n            console.log('valid')\n            this.$store.dispatch('cart/addCartItem', {'item': this.selectedProduct, 'amount': this.addModel.amount, 'comment': this.addModel.comment})\n            this.$Message.success({\n              title: '加入购物车成功',\n              content: '加入购物车成功'\n            })\n          } else {\n            console.log('invalid')\n            this.$Message.error(this.$t('invalideOrder'))\n          }\n        })\n      },\n      submitOrder: function () {\n        // console.log('submitting')\n        this.$refs['submitOrderForm'].validate((valid) => {\n          // console.log('submit Order validating')\n          console.log(valid)\n          if (valid) {\n            let params = {\n              department: this.currentDepartment,\n              customer: this.selectedCustomer,\n              payment: this.selectedPayment,\n              cartList: this.cartList,\n              cartListCount: this.cartListCount,\n              cartListSum: this.cartListSum.toFixed(this.decimals),\n              express: this.selectedExpress,\n              express_no: this.orderModel.express_no\n            }\n            console.log(params)\n            addOrder(params).then((res) => {\n              let { data, status, statusText } = res\n              if (status !== 201) {\n                console.log('submit order fail:' + statusText)\n              } else {\n                // console.log(data)\n                let message = data.order_no.substring(0, 4) + this.$t('orderAddedSucceed')\n                this.$Message.success({\n                  title: this.$t('orderAddedSucceed'),\n                  content: message\n                })\n                this.$store.dispatch('cart/emptyCart')\n              }\n            }, (error) => {\n              this.$Message.error(error)\n            }).catch((error) => {\n              this.$Message.error(error)\n            })\n          } else {\n            console.log('invalid')\n            this.$Message.error(this.$t('invalideOrder'))\n          }\n        })\n      }\n    },\n    mounted () {\n      this.getStockData(this.pageSize, this.pageNumber)\n      this.getCustomerData(this.pageSize, this.pageNumber)\n    }\n  }\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style lang=\"stylus\" scoped>\n  @import '../common/vars'\n\n  .cart-items\n    margin: 4px\n  .cart-enter\n    margin: 4px\n  .order-info\n    margin: 4px\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/OrderAdd.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"order-manage\"},[_c('div',{staticClass:\"cart-items\"},[_c('cart-items')],1),_vm._v(\" \"),_c('div',{staticClass:\"cart-enter\"},[_c('Form',{ref:\"addModelForm\",attrs:{\"model\":_vm.addModel,\"rules\":_vm.ruleAddValidate,\"label-position\":\"left\",\"inline\":\"\"}},[_c('Form-item',{attrs:{\"label\":_vm.$t('product'),\"prop\":\"name\"}},[_c('AutoComplete',{attrs:{\"placeholder\":_vm.$t('selectProduct'),\"icon\":\"ios-search\",\"clearable\":true},on:{\"on-select\":_vm.handleProductSelected},model:{value:(_vm.addModel.name),callback:function ($$v) {_vm.$set(_vm.addModel, \"name\", $$v)},expression:\"addModel.name\"}},_vm._l((_vm.aStockProduct),function(option){return _c('Option',{key:option.id,attrs:{\"value\":option.product_name}},[_c('span',{staticClass:\"product-name\"},[_vm._v(_vm._s(option.product_name))]),_vm._v(\" \"),_c('span',{staticClass:\"product-sale-price\"},[_vm._v(_vm._s(_vm._f(\"currency\")(option.product_sale_price)))]),_vm._v(\" \"),_c('span',{staticClass:\"product-amount\"},[_vm._v(_vm._s(option.amount))]),_vm._v(\" \"),_c('span',{staticClass:\"product-batch-no\"},[_vm._v(_vm._s(option.batch_no))])])})),_vm._v(\" \"),_vm._l((_vm.addModelErrors.name),function(error){return _c('ul',[_c('li',{staticClass:\"error\"},[_vm._v(_vm._s(error))])])})],2),_vm._v(\" \"),_c('Form-item',{attrs:{\"label\":_vm.$t('amount'),\"prop\":\"amount\"}},[_c('InputNumber',{attrs:{\"max\":10000,\"min\":0.1,\"step\":0.1},model:{value:(_vm.addModel.amount),callback:function ($$v) {_vm.$set(_vm.addModel, \"amount\", $$v)},expression:\"addModel.amount\"}}),_vm._v(\" \"),_vm._l((_vm.addModelErrors.amount),function(error){return _c('ul',[_c('li',{staticClass:\"error\"},[_vm._v(_vm._s(error))])])})],2),_vm._v(\" \"),_c('Form-item',{attrs:{\"label\":_vm.$t('comment'),\"prop\":\"comment\"}},[_c('Input',{attrs:{\"type\":\"text\"},model:{value:(_vm.addModel.comment),callback:function ($$v) {_vm.$set(_vm.addModel, \"comment\", $$v)},expression:\"addModel.comment\"}}),_vm._v(\" \"),_vm._l((_vm.addModelErrors.comment),function(error){return _c('ul',[_c('li',{staticClass:\"error\"},[_vm._v(_vm._s(error))])])})],2),_vm._v(\" \"),_c('Form-item',[_c('br'),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.addToCart()}}},[_vm._v(_vm._s(_vm.$t('addToCart')))])],1)],1),_vm._v(\" \"),_c('br')],1),_vm._v(\" \"),_c('div',{staticClass:\"order-info\"},[_c('Form',{ref:\"submitOrderForm\",attrs:{\"model\":_vm.orderModel,\"rules\":_vm.ruleOrderValidate,\"label-position\":\"left\",\"inline\":\"\"}},[_c('Form-item',{attrs:{\"label\":_vm.$t('customer'),\"prop\":\"customer\"}},[_c('AutoComplete',{attrs:{\"placeholder\":_vm.$t('selectCustomer'),\"icon\":\"ios-search\",\"clearable\":true},on:{\"on-select\":_vm.handleCustomerSelected},model:{value:(_vm.orderModel.customer),callback:function ($$v) {_vm.$set(_vm.orderModel, \"customer\", $$v)},expression:\"orderModel.customer\"}},_vm._l((_vm.aCustomer),function(option){return _c('Option',{key:option.id,attrs:{\"value\":option.username}},[_c('span',{staticClass:\"product-name\"},[_vm._v(_vm._s(option.username))]),_vm._v(\" \"),_c('span',{staticClass:\"product-price\"},[_vm._v(_vm._s(option.last_name))]),_vm._v(\" \"),_c('span',{staticClass:\"product-price\"},[_vm._v(_vm._s(option.first_name))]),_vm._v(\" \"),_c('span',{staticClass:\"product-price\"},[_vm._v(_vm._s(option.cell_phone))])])})),_vm._v(\" \"),_vm._l((_vm.orderErrors.customer),function(error){return _c('ul',[_c('li',{staticClass:\"error\"},[_vm._v(_vm._s(error))])])})],2),_vm._v(\" \"),_c('Form-item',{attrs:{\"label\":_vm.$t('payment'),\"prop\":\"payment\"}},[_c('AutoComplete',{attrs:{\"placeholder\":_vm.$t('selectPayment'),\"icon\":\"ios-search\",\"clearable\":true},on:{\"on-select\":_vm.handlePaymentSelected},model:{value:(_vm.orderModel.payment),callback:function ($$v) {_vm.$set(_vm.orderModel, \"payment\", $$v)},expression:\"orderModel.payment\"}},_vm._l((_vm.aPayment),function(option){return _c('Option',{key:option.id,attrs:{\"value\":option.name}},[_c('span',{staticClass:\"product-name\"},[_vm._v(_vm._s(option.name))])])})),_vm._v(\" \"),_vm._l((_vm.orderErrors.payment),function(error){return _c('ul',[_c('li',{staticClass:\"error\"},[_vm._v(_vm._s(error))])])})],2),_vm._v(\" \"),_c('Form-item',{attrs:{\"label\":_vm.$t('express'),\"prop\":\"express\"}},[_c('AutoComplete',{attrs:{\"placeholder\":_vm.$t('selectExpress'),\"icon\":\"ios-search\",\"clearable\":true},on:{\"on-select\":_vm.handleExpressSelected},model:{value:(_vm.orderModel.express),callback:function ($$v) {_vm.$set(_vm.orderModel, \"express\", $$v)},expression:\"orderModel.express\"}},_vm._l((_vm.aExpress),function(option){return _c('Option',{key:option.id,attrs:{\"value\":option.name}},[_c('span',{staticClass:\"product-name\"},[_vm._v(_vm._s(option.name))])])})),_vm._v(\" \"),_vm._l((_vm.orderErrors.express),function(error){return _c('ul',[_c('li',{staticClass:\"error\"},[_vm._v(_vm._s(error))])])})],2),_vm._v(\" \"),_c('Form-item',{attrs:{\"label\":_vm.$t('expressNo'),\"prop\":\"express_no\"}},[_c('Input',{attrs:{\"type\":\"text\"},model:{value:(_vm.orderModel.express_no),callback:function ($$v) {_vm.$set(_vm.orderModel, \"express_no\", $$v)},expression:\"orderModel.express_no\"}}),_vm._v(\" \"),_vm._l((_vm.orderErrors.express_no),function(error){return _c('ul',[_c('li',{staticClass:\"error\"},[_vm._v(_vm._s(error))])])})],2),_vm._v(\" \"),_c('Form-item',{attrs:{\"label\":_vm.$t('comment'),\"prop\":\"comment\"}},[_c('Input',{attrs:{\"type\":\"text\"},model:{value:(_vm.orderModel.comment),callback:function ($$v) {_vm.$set(_vm.orderModel, \"comment\", $$v)},expression:\"orderModel.comment\"}}),_vm._v(\" \"),_vm._l((_vm.orderErrors.comment),function(error){return _c('ul',[_c('li',{staticClass:\"error\"},[_vm._v(_vm._s(error))])])})],2),_vm._v(\" \"),_c('Form-item',{staticStyle:{\"display\":\"none\"},attrs:{\"prop\":\"cartListLength\"}},[_c('InputNumber',{attrs:{\"type\":\"text\"},model:{value:(_vm.orderModel.cartListLength),callback:function ($$v) {_vm.$set(_vm.orderModel, \"cartListLength\", $$v)},expression:\"orderModel.cartListLength\"}})],1),_vm._v(\" \"),_c('Form-item',[_c('br'),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\",\"size\":\"large\"},on:{\"click\":_vm.submitOrder}},[_c('Icon',{attrs:{\"type\":\"ios-download-outline\"}}),_vm._v(_vm._s(_vm.$t('submitOrder')))],1)],1)],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/.13.7.0@vue-loader/lib/template-compiler?{\"id\":\"data-v-1b5e2e83\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/.13.7.0@vue-loader/lib/selector.js?type=template&index=0!./src/views/OrderAdd.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/.3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/.13.7.0@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1b5e2e83\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/.13.7.0@vue-loader/lib/selector?type=styles&index=0!./OrderAdd.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/.13.7.0@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/.13.7.0@vue-loader/lib/selector?type=script&index=0!./OrderAdd.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/.13.7.0@vue-loader/lib/selector?type=script&index=0!./OrderAdd.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/.13.7.0@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1b5e2e83\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/.13.7.0@vue-loader/lib/selector?type=template&index=0!./OrderAdd.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1b5e2e83\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/OrderAdd.vue\n// module id = null\n// module chunks = ","<template lang=\"html\">\n  <div class=\"cart\">\n    <Table ref=\"cartList\" stripe :columns=\"cartListColumns\" :data=\"cartList\">\n      <div class=\"table-header\" slot=\"header\">\n        已添加商品列表\n      </div>\n\n      <div class=\"table-footer\" slot=\"footer\">\n        共计: <span>{{ cartListCount }}</span> 种商品，合计: <span>{{ cartListSum | currency }}</span>\n\n      </div>\n    </Table>\n    <br>\n  </div>\n</template>\n\n<script>\n  import { mapState, mapGetters, mapActions } from 'vuex'\n  import { getDepartments } from '@/http/api'\n\n  export default {\n    data () {\n      return {\n        emptyConfirm: false,\n        toDepartment: null,\n        cartListColumns: [\n          {\n            title: this.$t('product'),\n            key: 'name',\n            sortable: true,\n            render: (h, param) => {\n              let toUrl = {name: 'detail', params: {productId: param.row.id}}\n              return h('router-link',\n                {props: {\n                  to: toUrl\n                }}, param.row.name)\n            }\n          },\n          {\n            title: this.$t('sale_price'),\n            key: 'sale_price',\n            sortable: true\n          },\n          {\n            title: this.$t('decrease'),\n            key: 'decrease',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'warning',\n                    size: 'small',\n                    shape: 'circle'\n                  },\n                  on: {\n                    click: () => {\n                      this.decreaseCartItemAmount(params.row)\n                    }\n                  }\n                }, '-')\n              ])\n            }\n          },\n          {\n            title: this.$t('amount'),\n            key: 'amount',\n            sortable: true,\n            render: (h, params) => {\n              return h('span', params.row.amount.toFixed(this.decimals))\n            }\n          },\n          {\n            title: this.$t('increase'),\n            key: 'increase',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'warning',\n                    size: 'small',\n                    shape: 'circle'\n                  },\n                  on: {\n                    click: () => {\n                      this.increaseCartItemAmount(params.row)\n                    }\n                  }\n                }, '+')\n              ])\n            }\n          },\n          {\n            title: this.$t('itemSum'),\n            key: 'itemSum',\n            render: (h, params) => {\n              return h('span', (params.row.sale_price * params.row.amount).toFixed(this.decimals))\n            }\n          },\n          {\n            title: this.$t('comment'),\n            key: 'comment',\n            render: (h, params) => {\n              return h('span', params.row.comment)\n            }\n          },\n          {\n            title: this.$t('action'),\n            key: 'action',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'error',\n                    size: 'small'\n                  },\n                  on: {\n                    click: () => {\n                      this.removeCartItem(params.row)\n                    }\n                  }\n                }, this.$t('delete'))\n              ])\n            }\n          }\n        ]\n      }\n    },\n    computed: {\n      // 模块命名空间写法二\n      ...mapState({\n        otherDepartments: state => {\n          // 尝试复制一下，防止修改state原值\n          let tmpArray = JSON.parse(JSON.stringify(state.departments.results))\n          if (state.login.currentUser) {\n            // console.error(state.login.currentUser.department)\n            let tmpArray1 = tmpArray.filter((item, index, array) => {\n              // console.error(item.id)\n              return item.id !== state.login.currentUser.department\n            })\n            return tmpArray1\n          } else {\n            console.error(state.login.currentUser)\n            return tmpArray\n          }\n        }\n      }),\n      // 模块命名空间写法一\n      ...mapState('cart', {\n        cartList: state => state.cartList,\n        decimals: state => state.decimals\n      }),\n      ...mapGetters('cart', [\n        // 模块命名空间写法一\n        'cartListCount',\n        'cartListSum'\n      ])\n    },\n    methods: {\n      ...mapActions([\n        'setDepartments'\n      ]),\n      // 模块命名空间写法二\n      ...mapActions('cart', [\n        'emptyCart',\n        'setCartList',\n        'removeCartItem',\n        'resetCartList',\n        'decreaseCartItemAmount',\n        'increaseCartItemAmount'\n      ])\n      // checkoutCart: function (checkoutList) {\n      //   console.debug('checkout cart')\n      //   if (this.loginStatus) {\n      //     console.debug('checking')\n      //     this.$store.dispatch('emptyCart')\n      //   } else {\n      //     console.debug('redirecting')\n      //     this.$router.push({ name: 'login' })\n      //   }\n      // }\n    },\n    mounted () {\n      console.debug('Cart.vue mounted')\n    },\n    beforeCreate () {\n      // console.log('Cart.vue creating')\n      getDepartments().then((response) => {\n        let _this = this\n        _this.setDepartments(response.data).then(() => {\n          console.debug('state product list set')\n        })\n      }).catch(function (error) {\n        console.error(error)\n      })\n    }\n  }\n</script>\n\n<style lang=\"stylus\" scoped>\n  .cart-item\n    border: 1px solid\n  .footer\n    width: 100vw\n    height: 10vh\n    div\n      text-align: center\n  .table-header\n    font-size: 1.3em\n    text-align: center\n  .table-footer\n    font-size: 1.2em\n    margin: 1vh 3vw 6vh 1vw\n    span\n      color: red\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/components/cart/CartItems.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"cart\"},[_c('Table',{ref:\"cartList\",attrs:{\"stripe\":\"\",\"columns\":_vm.cartListColumns,\"data\":_vm.cartList}},[_c('div',{staticClass:\"table-header\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_vm._v(\"\\n      已添加商品列表\\n    \")]),_vm._v(\" \"),_c('div',{staticClass:\"table-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_vm._v(\"\\n      共计: \"),_c('span',[_vm._v(_vm._s(_vm.cartListCount))]),_vm._v(\" 种商品，合计: \"),_c('span',[_vm._v(_vm._s(_vm._f(\"currency\")(_vm.cartListSum)))])])]),_vm._v(\" \"),_c('br')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/.13.7.0@vue-loader/lib/template-compiler?{\"id\":\"data-v-28a19819\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/.13.7.0@vue-loader/lib/selector.js?type=template&index=0!./src/views/components/cart/CartItems.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/.3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/.13.7.0@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-28a19819\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/.13.7.0@vue-loader/lib/selector?type=styles&index=0!./CartItems.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/.13.7.0@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/.13.7.0@vue-loader/lib/selector?type=script&index=0!./CartItems.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/.13.7.0@vue-loader/lib/selector?type=script&index=0!./CartItems.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/.13.7.0@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-28a19819\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/.13.7.0@vue-loader/lib/selector?type=template&index=0!./CartItems.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-28a19819\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/components/cart/CartItems.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}