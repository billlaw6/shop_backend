webpackJsonp([10],{"1i1A":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("34v0"),r=a.n(o),n=a("EcfS"),s=a("m4jk"),i={components:{},data:function(){var e=this;return{total:0,keyword:"",dateRange:[new Date((new Date).getTime()-2592e5),new Date((new Date).getTime()+1728e5)],dateOptions:{shortcuts:[{text:"最近一周",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:"最近一个月",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}},{text:"最近三个月",value:function(){var e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]}}]},pageNumber:1,pageSize:10,moveRecordList:[],moveRecordColumns:[{title:this.$t("pageNo"),key:"page_no",sortable:!0,render:function(e,t){return e("span",t.row.page_no.substring(0,4))}},{title:this.$t("deptOut"),key:"dept_out_name",sortable:!0},{title:this.$t("deptIn"),key:"dept_in_name",sortable:!0},{title:this.$t("product"),key:"product_name",sortable:!0},{title:this.$t("salePrice"),key:"sale_price",sortable:!0},{title:this.$t("moveAmount"),key:"move_amount",sortable:!0},{title:this.$t("batchNo"),key:"batch_no",sortable:!0},{title:this.$t("status"),key:"status",filterMultiple:!0,filterMethod:function(e,t){return!0===e?!0===t.is_active:!1===e?!1===t.is_active:void 0},render:function(t,a){var o="";return a.row.dept_in_name===e.currentDepartment.name&&0===a.row.status&&/^0\d{4}/.test(a.row.dept_in)?o="toMoveIn":a.row.dept_in_name===e.currentDepartment.name&&1===a.row.status&&/^0\d{4}/.test(a.row.dept_out)?o="toCheck":a.row.dept_in_name!==e.currentDepartment.name||1!==a.row.status||/^0\d{4}/.test(a.row.dept_out)?a.row.dept_in_name===e.currentDepartment.name&&2===a.row.status&&/^0\d{4}/.test(a.row.dept_out)?o="beChecked":a.row.dept_in_name!==e.currentDepartment.name||2!==a.row.status||/^0\d{4}/.test(a.row.dept_out)?a.row.dept_out_name===e.currentDepartment.name&&0===a.row.status?o="toMoveOut":a.row.dept_out_name===e.currentDepartment.name&&1===a.row.status&&(o="toBeReceived"):o="beReceived":o="toBeReceived",t("span",{style:{marginRight:"5px"}},e.$t(o))}},{title:this.$t("process"),key:"action",render:function(t,a){var o="process";return a.row.dept_in_name===e.currentDepartment.name&&0===a.row.status?o="confirmMoveIn":a.row.dept_in_name===e.currentDepartment.name&&1===a.row.status&&/^0\d{4}/.test(a.row.dept_out)?o="confirmCheck":a.row.dept_in_name!==e.currentDepartment.name||1!==a.row.status||/^0\d{4}/.test(a.row.dept_out)?a.row.dept_out_name===e.currentDepartment.name&&0===a.row.status?o="confirmMoveOut":a.row.dept_out_name===e.currentDepartment.name&&1===a.row.status&&(o="process"):o="confirmReceive",t("Button",{props:{type:"primary",disabled:"process"===o,size:"small"},style:{marginRight:"5px"},on:{click:function(){e.handleProcessMoveRecord(a)}}},e.$t(o))}}]}},computed:r()({},Object(n.e)("login",{currentDepartment:function(e){return e.currentDepartment}}),{aStockMoveRecord:function(){var e=this;return this.moveRecordList?this.moveRecordList.filter(function(t,a,o){return!e.keyword||(-1!==t.page_no.toUpperCase().indexOf(e.keyword.toUpperCase())||(-1!==t.product_name.toUpperCase().indexOf(e.keyword.toUpperCase())||(-1!==t.product_py.toUpperCase().indexOf(e.keyword.toUpperCase())||(-1!==t.dept_in_name.toUpperCase().indexOf(e.keyword.toUpperCase())||-1!==t.dept_out_name.toUpperCase().indexOf(e.keyword.toUpperCase())))))}):[]}}),watch:{currentDepartment:function(e,t){console.log(e.code),this.getStockMoveRecordData(this.pageSize,this.pageNumber)}},methods:{handleProcessMoveRecord:function(e){var t=this,a={id:e.row.id,currentDept:this.currentDepartment};console.log(a),Object(s.t)(a).then(function(e){var a=e.status,o=e.data,r=e.statusText;201===a?(console.log(o),t.$Message.success(t.$t("processSucceed")),t.$Message.success(t.$t("newStockCreated")),t.getStockMoveRecordData(t.pageSize,t.pageNumber)):203===a?(console.log(o),t.$Message.success(t.$t("processSucceed")),t.getStockMoveRecordData(t.pageSize,t.pageNumber)):(console.log(r),t.$Message.error(t.$t("processFailed")))})},getStockMoveRecordData:function(e,t){var a=this,o={start:this.dateRange[0].getFullYear()+"-"+(this.dateRange[0].getMonth()+1)+"-"+this.dateRange[0].getDate(),end:this.dateRange[1].getFullYear()+"-"+(this.dateRange[1].getMonth()+1)+"-"+this.dateRange[1].getDate(),keyword:this.keyword,department:this.currentDepartment.code,limit:e,offset:(t-1)*e};Object(s.p)(o).then(function(e){console.log(e);var t=e.status,o=e.data,r=e.statusText;200!==t?console.log(r):(console.log(o),a.total=o.count,a.moveRecordList=o.results)})},changePage:function(e){this.pageNumber=e,this.getStockMoveRecordData(this.pageSize,this.pageNumber)},changePageSize:function(e){this.pageSize=e,this.getStockMoveRecordData(this.pageSize,this.pageNumber)},exportData:function(e){1===e?this.$refs.table.exportCsv({filename:"List"+new Date}):2===e?this.$refs.table.exportCsv({filename:"List_sorted_filtered"+new Date,original:!1}):3===e&&this.$refs.table.exportCsv({filename:"List_customed"+new Date,columns:this.tableColumns.filter(function(e,t){return t<4}),data:this.aStockMoveRecord.filter(function(e,t){return t<10})})}},mounted:function(){this.getStockMoveRecordData(this.pageSize,this.pageNumber)}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"move-record-process"},[a("Row",{staticClass:"search-box"},[a("Col",{attrs:{span:"6"}},[a("Date-picker",{attrs:{type:"daterange",format:"yyyy-MM-dd",options:e.dateOptions,placement:"bottom-start",placeholder:"订单创建时间"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),a("Col",{attrs:{span:"8"}},[a("AutoComplete",{attrs:{placeholder:e.$t("localSearch"),icon:"ios-search",clearable:!0},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},e._l(e.aStockMoveRecord,function(t){return a("Option",{key:t.id,attrs:{value:t.page_no}},[a("span",{staticClass:"name"},[e._v(e._s(t.page_no.substring(0,4)))]),e._v(" "),a("span",{staticClass:"product-name"},[e._v(e._s(t.product_name))]),e._v(" "),a("span",{staticClass:"sale-price"},[e._v(e._s(e._f("currency")(t.sale_price)))])])}))],1),e._v(" "),a("Col",{attrs:{span:"3"}},[a("i-button",{attrs:{type:"primary"},on:{click:function(t){e.getStockMoveRecordData(e.pageSize,e.pageNumber)}}},[e._v(e._s(e.$t("remoteSearch")))])],1)],1),e._v(" "),a("Table",{ref:"addedProduct",attrs:{stripe:"",columns:e.moveRecordColumns,data:e.aStockMoveRecord}},[a("div",{staticClass:"table-header",attrs:{slot:"header"},slot:"header"},[e._v("\n      待处理入出库\n    ")]),e._v(" "),a("div",{staticClass:"table-footer",attrs:{slot:"footer"},slot:"footer"},[e._v("\n      共计: "),a("span",[e._v(e._s(e.total))]),e._v(" 订单，合计: "),a("span")])]),e._v(" "),a("Button",{attrs:{type:"primary",size:"large"},on:{click:function(t){e.exportData(3)}}},[a("Icon",{attrs:{type:"ios-download-outline"}}),e._v(e._s(e.$t("exportCustomedData")))],1),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.total,current:e.pageNumber,"show-sizer":"","show-elevator":"","show-total":"","page-size":e.pageSize,"page-size-opts":[10,20,40,1e4]},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)])],1)},staticRenderFns:[]};var p=a("ngHh")(i,c,!1,function(e){a("HOrb")},"data-v-5b5dd0dc",null);t.default=p.exports},HOrb:function(e,t){}});
//# sourceMappingURL=10.8bf1574395a540032c50.js.map