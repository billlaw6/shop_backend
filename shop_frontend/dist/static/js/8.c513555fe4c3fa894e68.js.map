{"version":3,"sources":["webpack:///src/views/Cart.vue","webpack:///./src/views/Cart.vue?d1ed","webpack:///./src/views/Cart.vue","webpack:///src/views/components/cart/CartItems.vue","webpack:///./src/views/components/cart/CartItems.vue?2833","webpack:///./src/views/components/cart/CartItems.vue"],"names":["Cart","IndexHeader","IndexFooter","CartItems","_this2","this","row","computed","extends_default","Object","vuex_esm","loginStatus","currentUser","results","department","tmpArray","cartList","methods","_this3","error","views_Cart","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","type","label","justify","xs","span","lg","on","click","$event","emptyConfirm","size","title","on-ok","emptyCart","model","value","callback","$$v","expression","checkoutCart","is_staff","for","filterable","id","toDepartment","_l","item","key","_s","name","_e","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","props","param","decimals","comment","h","$t","cart_CartItems","ref","stripe","columns","cartListColumns","data","slot","cartListCount","_f","cartListSum"],"mappings":"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","file":"static/js/8.c513555fe4c3fa894e68.js","sourcesContent":["<template lang=\"html\">\n  <div class=\"cart\">\n    <index-header></index-header>\n\n    <cart-items></cart-items>\n    <br>\n\n    <Tabs type=\"card\">\n      <TabPane label=\"操作\">\n        <Row type=\"flex\" justify=\"end\" class=\"code-row-bg\">\n          <Col :xs=\"{ span: 12 }\" :lg=\"{ span: 6 }\" class=\"empty-cart\">\n            <Button type=\"error\" v-on:click=\"emptyConfirm=true\">\n              <Icon type=\"trash-a\" :size=\"18\"></Icon>\n              <span>清空购物车</span>\n            </Button>\n            <Modal v-model=\"emptyConfirm\" title=\"确认吗？\" @on-ok=\"emptyCart\">\n              <p>确认删除全部商品？</p>\n            </Modal>\n          </Col>\n          <Col :xs=\"{ span: 12 }\" :lg=\"{ span: 6 }\" class=\"checkout-cart\" v-on:click=\"checkoutCart\">\n            <Button type=\"primary\">\n              <Icon type=\"ios-cart\" :size=\"18\"></Icon>\n              <span>结算</span>\n            </Button>\n          </Col>\n        </Row>\n      </TabPane>\n      <br>\n      <TabPane label=\"店员操作\" v-if=\"currentUser && currentUser.is_staff\">\n        <Row type=\"flex\" justify=\"end\" class=\"code-row-bg\">\n          <Col :xs=\"{ span: 12 }\" :lg=\"{ span: 6 }\" class=\"move-in-cart\" v-on:click=\"checkoutCart\">\n            <Button type=\"primary\">\n              <Icon type=\"ios-download-outline\" :size=\"18\"></Icon>\n              <span>采购入库</span>\n            </Button>\n          </Col>\n          <Col :xs=\"{ span: 12 }\" :lg=\"{ span: 6 }\" class=\"move-out-cart\" v-on:click=\"checkoutCart\">\n            <Icon type=\"ios-upload\" :size=\"18\"></Icon>\n            <label for=\"toDepartment\">\n              <span>出库至</span>\n            </label>\n            <Select v-model=\"toDepartment\" filterable id=\"toDepartment\">\n              <Option v-for=\"item in otherDepartments\" :key=\"item.id\" :value=\"item.id\">{{ item.name }}</Option>\n            </Select>\n          </Col>\n        </Row>\n      </TabPane>\n    </Tabs>\n\n    <index-footer></index-footer> \n  </div>\n</template>\n\n<script>\n  import IndexHeader from '@/views/components/common/IndexHeader.vue'\n  import IndexFooter from '@/views/components/common/IndexFooter.vue'\n  import CartItems from '@/views/components/cart/CartItems.vue'\n  import { mapState, mapGetters, mapActions } from 'vuex'\n  import { getDepartments } from '@/http/api'\n\n  export default {\n    components: {\n      'index-header': IndexHeader,\n      'index-footer': IndexFooter,\n      'cart-items': CartItems\n    },\n    data () {\n      return {\n        emptyConfirm: false,\n        toDepartment: null,\n        cartListColumns: [\n          {\n            title: '商品名称',\n            key: 'name',\n            sortable: true\n          },\n          {\n            title: '单价',\n            key: 'price',\n            sortable: true\n          },\n          {\n            title: '减',\n            key: 'decrease',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'warning',\n                    size: 'small',\n                    shape: 'circle'\n                  },\n                  on: {\n                    click: () => {\n                      this.decreaseCartItemAmount(params.row)\n                    }\n                  }\n                }, '-')\n              ])\n            }\n          },\n          {\n            title: '数量',\n            key: 'amount',\n            sortable: true\n          },\n          {\n            title: '加',\n            key: 'increase',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'warning',\n                    size: 'small',\n                    shape: 'circle'\n                  },\n                  on: {\n                    click: () => {\n                      this.increaseCartItemAmount(params.row)\n                    }\n                  }\n                }, '+')\n              ])\n            }\n          },\n          {\n            title: '小计',\n            key: 'itemSum',\n            render: (h, params) => {\n              return h('span', (params.row.price * params.row.amount).toFixed(2))\n            }\n          },\n          {\n            title: '操作',\n            key: 'action',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'error',\n                    size: 'small'\n                  },\n                  on: {\n                    click: () => {\n                      this.removeCartItem(params.row)\n                    }\n                  }\n                }, '删除')\n              ])\n            }\n          }\n        ]\n      }\n    },\n    computed: {\n      // 模块命名空间写法二\n      ...mapState({\n        loginStatus: state => state.login.loginStatus,\n        currentUser: state => state.login.currentUser,\n        otherDepartments: state => {\n          // 尝试复制一下，防止修改state原值\n          let tmpArray = JSON.parse(JSON.stringify(state.departments.results))\n          if (state.login.currentUser) {\n            // console.error(state.login.currentUser.department)\n            let tmpArray1 = tmpArray.filter((item, index, array) => {\n              // console.error(item.id)\n              return item.id !== state.login.currentUser.department\n            })\n            return tmpArray1\n          } else {\n            console.error(state.login.currentUser)\n            return tmpArray\n          }\n        }\n      }),\n      // 模块命名空间写法一\n      ...mapState('cart', {\n        cartList: state => state.cartList\n      }),\n      ...mapGetters('cart', [\n        // 模块命名空间写法一\n        'cartListCount',\n        'cartListSum'\n      ])\n    },\n    methods: {\n      ...mapActions([\n        'setDepartments'\n      ]),\n      // 模块命名空间写法二\n      ...mapActions('cart', [\n        'emptyCart',\n        'setCartList',\n        'removeCartItem',\n        'resetCartList',\n        'decreaseCartItemAmount',\n        'increaseCartItemAmount'\n      ]),\n      checkoutCart: function (checkoutList) {\n        console.debug('checkout cart')\n        if (this.loginStatus) {\n          console.debug('checking')\n          this.$store.dispatch('emptyCart')\n        } else {\n          console.debug('redirecting')\n          this.$router.push({ name: 'login' })\n        }\n      }\n    },\n    mounted () {\n      console.debug('Cart.vue mounted')\n    },\n    beforeCreate () {\n      // console.log('Cart.vue creating')\n      getDepartments().then((response) => {\n        let _this = this\n        _this.setDepartments(response.data).then(() => {\n          console.debug('state product list set')\n        })\n      }).catch(function (error) {\n        console.error(error)\n      })\n    }\n  }\n</script>\n\n<style lang=\"stylus\" scoped>\n  .cart-item\n    border: 1px solid\n  .footer\n    width: 100vw\n    height: 10vh\n    div\n      text-align: center\n  .table-header\n    font-size: 1.3em\n    text-align: center\n  .table-footer\n    font-size: 1.2em\n    margin: 1vh 3vw 6vh 1vw\n    span\n      color: red\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/Cart.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"cart\"},[_c('index-header'),_vm._v(\" \"),_c('cart-items'),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('Tabs',{attrs:{\"type\":\"card\"}},[_c('TabPane',{attrs:{\"label\":\"操作\"}},[_c('Row',{staticClass:\"code-row-bg\",attrs:{\"type\":\"flex\",\"justify\":\"end\"}},[_c('Col',{staticClass:\"empty-cart\",attrs:{\"xs\":{ span: 12 },\"lg\":{ span: 6 }}},[_c('Button',{attrs:{\"type\":\"error\"},on:{\"click\":function($event){_vm.emptyConfirm=true}}},[_c('Icon',{attrs:{\"type\":\"trash-a\",\"size\":18}}),_vm._v(\" \"),_c('span',[_vm._v(\"清空购物车\")])],1),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"确认吗？\"},on:{\"on-ok\":_vm.emptyCart},model:{value:(_vm.emptyConfirm),callback:function ($$v) {_vm.emptyConfirm=$$v},expression:\"emptyConfirm\"}},[_c('p',[_vm._v(\"确认删除全部商品？\")])])],1),_vm._v(\" \"),_c('Col',{staticClass:\"checkout-cart\",attrs:{\"xs\":{ span: 12 },\"lg\":{ span: 6 }},on:{\"click\":_vm.checkoutCart}},[_c('Button',{attrs:{\"type\":\"primary\"}},[_c('Icon',{attrs:{\"type\":\"ios-cart\",\"size\":18}}),_vm._v(\" \"),_c('span',[_vm._v(\"结算\")])],1)],1)],1)],1),_vm._v(\" \"),_c('br'),_vm._v(\" \"),(_vm.currentUser && _vm.currentUser.is_staff)?_c('TabPane',{attrs:{\"label\":\"店员操作\"}},[_c('Row',{staticClass:\"code-row-bg\",attrs:{\"type\":\"flex\",\"justify\":\"end\"}},[_c('Col',{staticClass:\"move-in-cart\",attrs:{\"xs\":{ span: 12 },\"lg\":{ span: 6 }},on:{\"click\":_vm.checkoutCart}},[_c('Button',{attrs:{\"type\":\"primary\"}},[_c('Icon',{attrs:{\"type\":\"ios-download-outline\",\"size\":18}}),_vm._v(\" \"),_c('span',[_vm._v(\"采购入库\")])],1)],1),_vm._v(\" \"),_c('Col',{staticClass:\"move-out-cart\",attrs:{\"xs\":{ span: 12 },\"lg\":{ span: 6 }},on:{\"click\":_vm.checkoutCart}},[_c('Icon',{attrs:{\"type\":\"ios-upload\",\"size\":18}}),_vm._v(\" \"),_c('label',{attrs:{\"for\":\"toDepartment\"}},[_c('span',[_vm._v(\"出库至\")])]),_vm._v(\" \"),_c('Select',{attrs:{\"filterable\":\"\",\"id\":\"toDepartment\"},model:{value:(_vm.toDepartment),callback:function ($$v) {_vm.toDepartment=$$v},expression:\"toDepartment\"}},_vm._l((_vm.otherDepartments),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(_vm._s(item.name))])}))],1)],1)],1):_vm._e()],1),_vm._v(\" \"),_c('index-footer')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/.13.7.0@vue-loader/lib/template-compiler?{\"id\":\"data-v-533a572c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/.13.7.0@vue-loader/lib/selector.js?type=template&index=0!./src/views/Cart.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/.3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/.13.7.0@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-533a572c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../node_modules/.13.7.0@vue-loader/lib/selector?type=styles&index=0!./Cart.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/.13.7.0@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/.13.7.0@vue-loader/lib/selector?type=script&index=0!./Cart.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/.13.7.0@vue-loader/lib/selector?type=script&index=0!./Cart.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/.13.7.0@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-533a572c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/.13.7.0@vue-loader/lib/selector?type=template&index=0!./Cart.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-533a572c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/Cart.vue\n// module id = null\n// module chunks = ","<template lang=\"html\">\n  <div class=\"cart\">\n    <Table ref=\"cartList\" stripe :columns=\"cartListColumns\" :data=\"cartList\">\n      <div class=\"table-header\" slot=\"header\">\n        已添加商品列表\n      </div>\n\n      <div class=\"table-footer\" slot=\"footer\">\n        共计: <span>{{ cartListCount }}</span> 种商品，合计: <span>{{ cartListSum | currency }}</span>\n\n      </div>\n    </Table>\n    <br>\n  </div>\n</template>\n\n<script>\n  import { mapState, mapGetters, mapActions } from 'vuex'\n  import { getDepartments } from '@/http/api'\n\n  export default {\n    data () {\n      return {\n        emptyConfirm: false,\n        toDepartment: null,\n        cartListColumns: [\n          {\n            title: this.$t('product'),\n            key: 'name',\n            sortable: true,\n            render: (h, param) => {\n              let toUrl = {name: 'detail', params: {productId: param.row.id}}\n              return h('router-link',\n                {props: {\n                  to: toUrl\n                }}, param.row.name)\n            }\n          },\n          {\n            title: this.$t('sale_price'),\n            key: 'sale_price',\n            sortable: true\n          },\n          {\n            title: this.$t('decrease'),\n            key: 'decrease',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'warning',\n                    size: 'small',\n                    shape: 'circle'\n                  },\n                  on: {\n                    click: () => {\n                      this.decreaseCartItemAmount(params.row)\n                    }\n                  }\n                }, '-')\n              ])\n            }\n          },\n          {\n            title: this.$t('amount'),\n            key: 'amount',\n            sortable: true,\n            render: (h, params) => {\n              return h('span', params.row.amount.toFixed(this.decimals))\n            }\n          },\n          {\n            title: this.$t('increase'),\n            key: 'increase',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'warning',\n                    size: 'small',\n                    shape: 'circle'\n                  },\n                  on: {\n                    click: () => {\n                      this.increaseCartItemAmount(params.row)\n                    }\n                  }\n                }, '+')\n              ])\n            }\n          },\n          {\n            title: this.$t('itemSum'),\n            key: 'itemSum',\n            render: (h, params) => {\n              return h('span', (params.row.sale_price * params.row.amount).toFixed(this.decimals))\n            }\n          },\n          {\n            title: this.$t('comment'),\n            key: 'comment',\n            render: (h, params) => {\n              return h('span', params.row.comment)\n            }\n          },\n          {\n            title: this.$t('action'),\n            key: 'action',\n            render: (h, params) => {\n              return h('div', [\n                h('Button', {\n                  props: {\n                    type: 'error',\n                    size: 'small'\n                  },\n                  on: {\n                    click: () => {\n                      this.removeCartItem(params.row)\n                    }\n                  }\n                }, this.$t('delete'))\n              ])\n            }\n          }\n        ]\n      }\n    },\n    computed: {\n      // 模块命名空间写法二\n      ...mapState({\n        otherDepartments: state => {\n          // 尝试复制一下，防止修改state原值\n          let tmpArray = JSON.parse(JSON.stringify(state.departments.results))\n          if (state.login.currentUser) {\n            // console.error(state.login.currentUser.department)\n            let tmpArray1 = tmpArray.filter((item, index, array) => {\n              // console.error(item.id)\n              return item.id !== state.login.currentUser.department\n            })\n            return tmpArray1\n          } else {\n            console.error(state.login.currentUser)\n            return tmpArray\n          }\n        }\n      }),\n      // 模块命名空间写法一\n      ...mapState('cart', {\n        cartList: state => state.cartList,\n        decimals: state => state.decimals\n      }),\n      ...mapGetters('cart', [\n        // 模块命名空间写法一\n        'cartListCount',\n        'cartListSum'\n      ])\n    },\n    methods: {\n      ...mapActions([\n        'setDepartments'\n      ]),\n      // 模块命名空间写法二\n      ...mapActions('cart', [\n        'emptyCart',\n        'setCartList',\n        'removeCartItem',\n        'resetCartList',\n        'decreaseCartItemAmount',\n        'increaseCartItemAmount'\n      ])\n      // checkoutCart: function (checkoutList) {\n      //   console.debug('checkout cart')\n      //   if (this.loginStatus) {\n      //     console.debug('checking')\n      //     this.$store.dispatch('emptyCart')\n      //   } else {\n      //     console.debug('redirecting')\n      //     this.$router.push({ name: 'login' })\n      //   }\n      // }\n    },\n    mounted () {\n      console.debug('Cart.vue mounted')\n    },\n    beforeCreate () {\n      // console.log('Cart.vue creating')\n      getDepartments().then((response) => {\n        let _this = this\n        _this.setDepartments(response.data).then(() => {\n          console.debug('state product list set')\n        })\n      }).catch(function (error) {\n        console.error(error)\n      })\n    }\n  }\n</script>\n\n<style lang=\"stylus\" scoped>\n  .cart-item\n    border: 1px solid\n  .footer\n    width: 100vw\n    height: 10vh\n    div\n      text-align: center\n  .table-header\n    font-size: 1.3em\n    text-align: center\n  .table-footer\n    font-size: 1.2em\n    margin: 1vh 3vw 6vh 1vw\n    span\n      color: red\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/components/cart/CartItems.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"cart\"},[_c('Table',{ref:\"cartList\",attrs:{\"stripe\":\"\",\"columns\":_vm.cartListColumns,\"data\":_vm.cartList}},[_c('div',{staticClass:\"table-header\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_vm._v(\"\\n      已添加商品列表\\n    \")]),_vm._v(\" \"),_c('div',{staticClass:\"table-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_vm._v(\"\\n      共计: \"),_c('span',[_vm._v(_vm._s(_vm.cartListCount))]),_vm._v(\" 种商品，合计: \"),_c('span',[_vm._v(_vm._s(_vm._f(\"currency\")(_vm.cartListSum)))])])]),_vm._v(\" \"),_c('br')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/.13.7.0@vue-loader/lib/template-compiler?{\"id\":\"data-v-28a19819\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/.13.7.0@vue-loader/lib/selector.js?type=template&index=0!./src/views/components/cart/CartItems.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/.3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/.13.7.0@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-28a19819\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/.13.7.0@vue-loader/lib/selector?type=styles&index=0!./CartItems.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/.13.7.0@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/.13.7.0@vue-loader/lib/selector?type=script&index=0!./CartItems.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/.13.7.0@vue-loader/lib/selector?type=script&index=0!./CartItems.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/.13.7.0@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-28a19819\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/.13.7.0@vue-loader/lib/selector?type=template&index=0!./CartItems.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-28a19819\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/components/cart/CartItems.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}