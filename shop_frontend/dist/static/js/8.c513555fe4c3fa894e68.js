webpackJsonp([8],{"5Z7Z":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("3SZ7"),a=r.n(n),s=r("34v0"),o=r.n(s),i=r("IPfJ"),c=r("/e58"),u=r("kJIr"),l=r("EcfS"),m=r("m4jk"),p={components:{"index-header":i.a,"index-footer":c.a,"cart-items":u.a},data:function(){var t=this;return{emptyConfirm:!1,toDepartment:null,cartListColumns:[{title:"商品名称",key:"name",sortable:!0},{title:"单价",key:"price",sortable:!0},{title:"减",key:"decrease",render:function(e,r){return e("div",[e("Button",{props:{type:"warning",size:"small",shape:"circle"},on:{click:function(){t.decreaseCartItemAmount(r.row)}}},"-")])}},{title:"数量",key:"amount",sortable:!0},{title:"加",key:"increase",render:function(e,r){return e("div",[e("Button",{props:{type:"warning",size:"small",shape:"circle"},on:{click:function(){t.increaseCartItemAmount(r.row)}}},"+")])}},{title:"小计",key:"itemSum",render:function(t,e){return t("span",(e.row.price*e.row.amount).toFixed(2))}},{title:"操作",key:"action",render:function(e,r){return e("div",[e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.removeCartItem(r.row)}}},"删除")])}}]}},computed:o()({},Object(l.e)({loginStatus:function(t){return t.login.loginStatus},currentUser:function(t){return t.login.currentUser},otherDepartments:function(t){var e=JSON.parse(a()(t.departments.results));return t.login.currentUser?e.filter(function(e,r,n){return e.id!==t.login.currentUser.department}):(console.error(t.login.currentUser),e)}}),Object(l.e)("cart",{cartList:function(t){return t.cartList}}),Object(l.c)("cart",["cartListCount","cartListSum"])),methods:o()({},Object(l.b)(["setDepartments"]),Object(l.b)("cart",["emptyCart","setCartList","removeCartItem","resetCartList","decreaseCartItemAmount","increaseCartItemAmount"]),{checkoutCart:function(t){console.debug("checkout cart"),this.loginStatus?(console.debug("checking"),this.$store.dispatch("emptyCart")):(console.debug("redirecting"),this.$router.push({name:"login"}))}}),mounted:function(){console.debug("Cart.vue mounted")},beforeCreate:function(){var t=this;Object(m.i)().then(function(e){t.setDepartments(e.data).then(function(){console.debug("state product list set")})}).catch(function(t){console.error(t)})}},d={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cart"},[r("index-header"),t._v(" "),r("cart-items"),t._v(" "),r("br"),t._v(" "),r("Tabs",{attrs:{type:"card"}},[r("TabPane",{attrs:{label:"操作"}},[r("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"end"}},[r("Col",{staticClass:"empty-cart",attrs:{xs:{span:12},lg:{span:6}}},[r("Button",{attrs:{type:"error"},on:{click:function(e){t.emptyConfirm=!0}}},[r("Icon",{attrs:{type:"trash-a",size:18}}),t._v(" "),r("span",[t._v("清空购物车")])],1),t._v(" "),r("Modal",{attrs:{title:"确认吗？"},on:{"on-ok":t.emptyCart},model:{value:t.emptyConfirm,callback:function(e){t.emptyConfirm=e},expression:"emptyConfirm"}},[r("p",[t._v("确认删除全部商品？")])])],1),t._v(" "),r("Col",{staticClass:"checkout-cart",attrs:{xs:{span:12},lg:{span:6}},on:{click:t.checkoutCart}},[r("Button",{attrs:{type:"primary"}},[r("Icon",{attrs:{type:"ios-cart",size:18}}),t._v(" "),r("span",[t._v("结算")])],1)],1)],1)],1),t._v(" "),r("br"),t._v(" "),t.currentUser&&t.currentUser.is_staff?r("TabPane",{attrs:{label:"店员操作"}},[r("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"end"}},[r("Col",{staticClass:"move-in-cart",attrs:{xs:{span:12},lg:{span:6}},on:{click:t.checkoutCart}},[r("Button",{attrs:{type:"primary"}},[r("Icon",{attrs:{type:"ios-download-outline",size:18}}),t._v(" "),r("span",[t._v("采购入库")])],1)],1),t._v(" "),r("Col",{staticClass:"move-out-cart",attrs:{xs:{span:12},lg:{span:6}},on:{click:t.checkoutCart}},[r("Icon",{attrs:{type:"ios-upload",size:18}}),t._v(" "),r("label",{attrs:{for:"toDepartment"}},[r("span",[t._v("出库至")])]),t._v(" "),r("Select",{attrs:{filterable:"",id:"toDepartment"},model:{value:t.toDepartment,callback:function(e){t.toDepartment=e},expression:"toDepartment"}},t._l(t.otherDepartments,function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1)],1)],1):t._e()],1),t._v(" "),r("index-footer")],1)},staticRenderFns:[]};var f=r("ngHh")(p,d,!1,function(t){r("aIgW")},"data-v-533a572c",null);e.default=f.exports},"QlC+":function(t,e){},aIgW:function(t,e){},kJIr:function(t,e,r){"use strict";var n=r("3SZ7"),a=r.n(n),s=r("34v0"),o=r.n(s),i=r("EcfS"),c=r("m4jk"),u={data:function(){var t=this;return{emptyConfirm:!1,toDepartment:null,cartListColumns:[{title:this.$t("product"),key:"name",sortable:!0,render:function(t,e){return t("router-link",{props:{to:{name:"detail",params:{productId:e.row.id}}}},e.row.name)}},{title:this.$t("sale_price"),key:"sale_price",sortable:!0},{title:this.$t("decrease"),key:"decrease",render:function(e,r){return e("div",[e("Button",{props:{type:"warning",size:"small",shape:"circle"},on:{click:function(){t.decreaseCartItemAmount(r.row)}}},"-")])}},{title:this.$t("amount"),key:"amount",sortable:!0,render:function(e,r){return e("span",r.row.amount.toFixed(t.decimals))}},{title:this.$t("increase"),key:"increase",render:function(e,r){return e("div",[e("Button",{props:{type:"warning",size:"small",shape:"circle"},on:{click:function(){t.increaseCartItemAmount(r.row)}}},"+")])}},{title:this.$t("itemSum"),key:"itemSum",render:function(e,r){return e("span",(r.row.sale_price*r.row.amount).toFixed(t.decimals))}},{title:this.$t("comment"),key:"comment",render:function(t,e){return t("span",e.row.comment)}},{title:this.$t("action"),key:"action",render:function(e,r){return e("div",[e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.removeCartItem(r.row)}}},t.$t("delete"))])}}]}},computed:o()({},Object(i.e)({otherDepartments:function(t){var e=JSON.parse(a()(t.departments.results));return t.login.currentUser?e.filter(function(e,r,n){return e.id!==t.login.currentUser.department}):(console.error(t.login.currentUser),e)}}),Object(i.e)("cart",{cartList:function(t){return t.cartList},decimals:function(t){return t.decimals}}),Object(i.c)("cart",["cartListCount","cartListSum"])),methods:o()({},Object(i.b)(["setDepartments"]),Object(i.b)("cart",["emptyCart","setCartList","removeCartItem","resetCartList","decreaseCartItemAmount","increaseCartItemAmount"])),mounted:function(){console.debug("Cart.vue mounted")},beforeCreate:function(){var t=this;Object(c.i)().then(function(e){t.setDepartments(e.data).then(function(){console.debug("state product list set")})}).catch(function(t){console.error(t)})}},l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"cart"},[e("Table",{ref:"cartList",attrs:{stripe:"",columns:this.cartListColumns,data:this.cartList}},[e("div",{staticClass:"table-header",attrs:{slot:"header"},slot:"header"},[this._v("\n      已添加商品列表\n    ")]),this._v(" "),e("div",{staticClass:"table-footer",attrs:{slot:"footer"},slot:"footer"},[this._v("\n      共计: "),e("span",[this._v(this._s(this.cartListCount))]),this._v(" 种商品，合计: "),e("span",[this._v(this._s(this._f("currency")(this.cartListSum)))])])]),this._v(" "),e("br")],1)},staticRenderFns:[]};var m=r("ngHh")(u,l,!1,function(t){r("QlC+")},"data-v-28a19819",null);e.a=m.exports}});
//# sourceMappingURL=8.c513555fe4c3fa894e68.js.map